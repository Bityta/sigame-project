# üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π CI/CD –î–µ–ø–ª–æ–π

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ GitHub Actions. –ü—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main` –≤–µ—Ç–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ã.

---

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–¥–∏–Ω —Ä–∞–∑)

### –®–∞–≥ 1: –î–æ–±–∞–≤—å—Ç–µ SSH –∫–ª—é—á –≤ GitHub Secrets

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á:
```bash
cat ~/.ssh/id_rsa
```

2. –û—Ç–∫—Ä–æ–π—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**

3. –ù–∞–∂–º–∏—Ç–µ **New repository secret** –∏ –¥–æ–±–∞–≤—å—Ç–µ:

**–ò–º—è:** `SSH_PRIVATE_KEY`  
**–ó–Ω–∞—á–µ–Ω–∏–µ:** –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–≤–µ—Å—å —Ç–µ–∫—Å—Ç –æ—Ç `-----BEGIN` –¥–æ `-----END`)

### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ IP –∞–¥—Ä–µ—Å–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤

–î–æ–±–∞–≤—å—Ç–µ –µ—â–µ 2 —Å–µ–∫—Ä–µ—Ç–∞:

**–ò–º—è:** `APP_SERVER_IP`  
**–ó–Ω–∞—á–µ–Ω–∏–µ:** `89.169.139.21`

**–ò–º—è:** `INFRA_SERVER_IP`  
**–ó–Ω–∞—á–µ–Ω–∏–µ:** `10.129.0.26`

---

## ‚ú® –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (–ø—Ä–∏ git push):

```bash
git add .
git commit -m "Updated frontend"
git push origin main
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
1. ‚úÖ GitHub Actions –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
2. ‚úÖ –ö–æ–¥ —Å–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ–±–∞ —Å–µ—Ä–≤–µ—Ä–∞
3. ‚úÖ Docker –æ–±—Ä–∞–∑—ã –ø–µ—Ä–µ—Å–æ–±–µ—Ä—É—Ç—Å—è
4. ‚úÖ –°–µ—Ä–≤–∏—Å—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç—è—Ç—Å—è (zero-downtime)
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
6. ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ

**–í—Ä–µ–º—è –¥–µ–ø–ª–æ—è:** ~3-5 –º–∏–Ω—É—Ç

---

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π:

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –±–µ–∑ git push:

```bash
# –ù–∞ –≤–∞—à–µ–º Mac
cd /Users/bituckihs/Documents/sigame-project
./deployment/scripts/manual-deploy.sh
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–ª–æ—è

### –°–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions**
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π workflow

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–∑–≤–µ—Ä–Ω—É–ª–æ—Å—å:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh ubuntu@89.169.139.21

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
cd /opt/sigame
docker compose -f docker-compose.app.yml ps

# –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker compose -f docker-compose.app.yml logs -f [service-name]
```

---

## üîÑ –ß—Ç–æ –¥–µ–ø–ª–æ–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

‚úÖ **Frontend** - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –≤ `frontend/`  
‚úÖ **Auth Service** - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `services/auth/`  
‚úÖ **Lobby Service** - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `services/lobby/`  
‚úÖ **Game Service** - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `services/game/`  
‚úÖ **Pack Service** - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `services/packs/`  
‚úÖ **Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `docker-compose.app.yml`

**Infrastructure —Å–µ—Ä–≤–µ—Ä** –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `docker-compose.infra.yml` –∏–ª–∏ —Ñ–∞–π–ª–æ–≤ –≤ `infrastructure/`

---

## üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞

### –ï—Å–ª–∏ –¥–µ–ø–ª–æ–π —É–ø–∞–ª:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ GitHub Actions
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
```bash
docker compose -f docker-compose.app.yml ps
docker compose -f docker-compose.app.yml logs
```

### –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/sigame
git log --oneline  # –ù–∞–π–¥–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∫–æ–º–º–∏—Ç
git checkout <commit-hash>
docker compose -f docker-compose.app.yml up -d --build
```

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
gh run list --limit 1

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
gh run rerun

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
ssh ubuntu@89.169.139.21 "cd /opt/sigame && docker compose -f docker-compose.app.yml down"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
ssh ubuntu@89.169.139.21 "cd /opt/sigame && docker compose -f docker-compose.app.yml up -d"
```

---

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Å—Ç–æ —Ä–∞–±–æ—Ç–∞–π—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ:

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
code .

# –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
git add .
git commit -m "Feature: new awesome feature"
git push

# –î–µ–ø–ª–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! üéâ
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ 3-5 –º–∏–Ω—É—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: http://89.169.139.21:3001

---

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!** üöÄ

